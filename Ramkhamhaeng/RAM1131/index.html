<!-- RAM1131-HTML-08102025-09 -->
<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>RAM1131 — 20nxskypqz Exam Review</title>

  <link href="https://fonts.googleapis.com/css2?family=Niramit:wght@400;700&display=swap" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />

  <!-- reuse CSS/JS จากโฟลเดอร์แม่ -->
  <link rel="stylesheet" href="../styles.css" />
</head>
<body>
  <!-- Header (inline) -->
  <header class="header full-bleed">
    <button class="menu-toggle" aria-label="Toggle navigation" type="button">
      <span class="material-symbols-outlined">menu</span>
    </button>

    <div class="toggle-container" id="mode-toggle" aria-label="Toggle light/dark mode" role="button" tabindex="0">
      <div class="toggle-circle">
        <span class="material-symbols-outlined" id="mode-icon" aria-hidden="true">light_mode</span>
      </div>
    </div>
  </header>

  <!-- Side menu -->
  <div data-include="../shared/side-menu.html"></div>

  <main class="content">
    <!-- หัวเรื่องอยู่นอกกล่อง + กึ่งกลาง + ขนาด 24px (h3) -->
    <section class="hero">
      <h3 class="hero-title">RAM1131 – ทักษะการเข้าใจดิจิทัล</h3>
    </section>

    <!-- เอกสาร 1 -->
    <section class="section-card">
      <h3 class="align-left" style="margin:0 0 8px;">บทที่ 1 – สิทธิและความรับผิดชอบ</h3>
      <div class="card" id="chapter-status" style="font-weight:700;color:#666;margin-bottom:8px;">Loading document…</div>
      <div class="card" id="chapter-box">Preparing…</div>
    </section>

    <!-- เอกสาร 2 -->
    <section class="section-card">
      <h3 class="align-left" style="margin:0 0 8px;">บทที่ 2 – การเข้าถึงดิจิทัล</h3>
      <div class="card" id="chapter2-status" style="font-weight:700;color:#666;margin-bottom:8px;">Loading document…</div>
      <div class="card" id="chapter2-box">Preparing…</div>
    </section>

    <!-- เอกสาร 3 -->
    <section class="section-card">
      <h3 class="align-left" style="margin:0 0 8px;">บทที่ 3 – การสื่อสารและการปฏิสัมพันธ์ในยุคดิจิทัล</h3>
      <div class="card" id="chapter3-status" style="font-weight:700;color:#666;margin-bottom:8px;">Loading document…</div>
      <div class="card" id="chapter3-box">Preparing…</div>
    </section>
  </main>

  <!-- Footer (inline) -->
  <footer class="footer full-bleed">&copy; 2025 20nxskypqz Exam Review</footer>

  <!-- Mammoth (DOCX → HTML) -->
  <script src="https://unpkg.com/mammoth/mammoth.browser.min.js"></script>

  <!-- reuse JS จากโฟลเดอร์แม่ -->
  <script src="../script.js"></script>

  <!-- หน้านี้: ดึงไฟล์ DOCX และเรนเดอร์ + remap font-size → h1/h2/h3/p -->
  <script>
    // แมปขนาดจาก Word → แท็กหัวเรื่อง/ย่อหน้า และล้าง inline font-size
    function remapFontSizeToHeadings(container){
      if (!container) return;

      const pickLevel = (pt) => {
        if (pt >= 24.5 && pt <= 26.5) return 'h1';        // ~25 pt → 28px
        if (pt >= 19.5 && pt <= 20.5) return 'h2';        // ~20 pt → 24px
        if ((pt >= 17 && pt <= 18.5) || (pt >= 13.5 && pt <= 14.5)) return 'h3'; // ~17.5/14 pt → 20px
        if (pt >= 11.5 && pt <= 12.5) return 'p';         // ~12 pt → 16px
        return null;
      };

      const stripFontSize = (el) => {
        if (el.hasAttribute && el.hasAttribute('style')){
          const cleaned = el.getAttribute('style').replace(/font-size:[^;"]*;?/gi,'').trim();
          if (cleaned) el.setAttribute('style', cleaned); else el.removeAttribute('style');
        }
        for (const child of el.children || []) stripFontSize(child);
      };

      container.querySelectorAll('p').forEach(p => {
        // หา font-size ที่ใหญ่สุดใน p (จาก inline style)
        let maxPt = null;
        const scan = (el)=>{
          if (el.nodeType === 1){ // ELEMENT
            const st = el.getAttribute && el.getAttribute('style');
            if (st){
              const m = st.match(/font-size:\s*([\d.]+)\s*pt/i);
              if (m){ const v = parseFloat(m[1]); if (!isNaN(v)) maxPt = Math.max(maxPt ?? 0, v); }
            }
            for (const ch of el.children) scan(ch);
          }
        };
        scan(p);

        const level = (maxPt!=null) ? pickLevel(maxPt) : null;
        if (level && level !== 'p'){
          const h = document.createElement(level);
          // ย้ายลูกทั้งหมด แล้วล้าง inline font-size
          while (p.firstChild) h.appendChild(p.firstChild);
          stripFontSize(h);
          p.replaceWith(h);
        }else{
          // p ธรรมดา: ล้าง font-size ออก
          stripFontSize(p);
        }
      });
    }

    // ===== เอกสาร 1 =====
    (function () {
      const statusEl = document.getElementById('chapter-status');
      const boxEl    = document.getElementById('chapter-box');
      const fileUrl  = "files/บทที่ 1 – สิทธิและความรับผิดชอบ.docx";

      const options = {
        styleMap: [
          "p[style-name='Title'] => h1:fresh",
          "p[style-name='Subtitle'] => h2:fresh",
          "p[style-name='Heading 1'] => h1:fresh",
          "p[style-name='Heading 2'] => h2:fresh",
          "p[style-name='Heading 3'] => h3:fresh",
          "b => strong",
          "i => em"
        ]
      };

      function fixListSpacing(container){
        container.querySelectorAll('li').forEach(li=>{
          li.innerHTML = li.innerHTML
            .replace(/^(\d+)\.\s?/, (_,m)=> m + '. ')
            .replace(/^•\s?/, '• ');
        });
      }

      async function loadArrayBuffer(url){
        const res = await fetch(encodeURI(url), { cache: 'no-store' });
        if(!res.ok) throw new Error('โหลดไฟล์ไม่ได้: ' + url + ' [' + res.status + ']');
        return await res.arrayBuffer();
      }

      (async () => {
        try{
          const buf = await loadArrayBuffer(fileUrl);
          const { value: html } = await window.mammoth.convertToHtml({ arrayBuffer: buf }, options);
          boxEl.innerHTML = html;
          remapFontSizeToHeadings(boxEl);
          fixListSpacing(boxEl);
          statusEl.textContent = 'Done.';
        }catch(e){
          console.error(e);
          statusEl.textContent = 'Error loading document.';
          boxEl.innerHTML = '<div style="color:#c00;font-weight:700">เกิดข้อผิดพลาดในการโหลดเอกสาร</div>';
        }
      })();
    })();

    // ===== เอกสาร 2 =====
    (function () {
      const statusEl = document.getElementById('chapter2-status');
      const boxEl    = document.getElementById('chapter2-box');
      const fileUrl  = "files/บทที่ 2 – การเข้าถึงดิจิทัล.docx";

      const options = {
        styleMap: [
          "p[style-name='Title'] => h1:fresh",
          "p[style-name='Subtitle'] => h2:fresh",
          "p[style-name='Heading 1'] => h1:fresh",
          "p[style-name='Heading 2'] => h2:fresh",
          "p[style-name='Heading 3'] => h3:fresh",
          "b => strong",
          "i => em"
        ]
      };

      function fixListSpacing(container){
        container.querySelectorAll('li').forEach(li=>{
          li.innerHTML = li.innerHTML
            .replace(/^(\d+)\.\s?/, (_,m)=> m + '. ')
            .replace(/^•\s?/, '• ');
        });
      }

      async function loadArrayBuffer(url){
        const res = await fetch(encodeURI(url), { cache: 'no-store' });
        if(!res.ok) throw new Error('โหลดไฟล์ไม่ได้: ' + url + ' [' + res.status + ']');
        return await res.arrayBuffer();
      }

      (async () => {
        try{
          const buf = await loadArrayBuffer(fileUrl);
          const { value: html } = await window.mammoth.convertToHtml({ arrayBuffer: buf }, options);
          boxEl.innerHTML = html;
          remapFontSizeToHeadings(boxEl);
          fixListSpacing(boxEl);
          statusEl.textContent = 'Done.';
        }catch(e){
          console.error(e);
          statusEl.textContent = 'Error loading document.';
          boxEl.innerHTML = '<div style="color:#c00;font-weight:700">เกิดข้อผิดพลาดในการโหลดเอกสาร</div>';
        }
      })();
    })();

    // ===== เอกสาร 3 =====
    (function () {
      const statusEl = document.getElementById('chapter3-status');
      const boxEl    = document.getElementById('chapter3-box');
      const fileUrl  = "files/บทที่ 3 – การสื่อสารและการปฏิสัมพันธ์ในยุคดิจิทัล.docx";

      const options = {
        styleMap: [
          "p[style-name='Title'] => h1:fresh",
          "p[style-name='Subtitle'] => h2:fresh",
          "p[style-name='Heading 1'] => h1:fresh",
          "p[style-name='Heading 2'] => h2:fresh",
          "p[style-name='Heading 3'] => h3:fresh",
          "b => strong",
          "i => em"
        ]
      };

      function fixListSpacing(container){
        container.querySelectorAll('li').forEach(li=>{
          li.innerHTML = li.innerHTML
            .replace(/^(\d+)\.\s?/, (_,m)=> m + '. ')
            .replace(/^•\s?/, '• ');
        });
      }

      async function loadArrayBuffer(url){
        const res = await fetch(encodeURI(url), { cache: 'no-store' });
        if(!res.ok) throw new Error('โหลดไฟล์ไม่ได้: ' + url + ' [' + res.status + ']');
        return await res.arrayBuffer();
      }

      (async () => {
        try{
          const buf = await loadArrayBuffer(fileUrl);
          const { value: html } = await window.mammoth.convertToHtml({ arrayBuffer: buf }, options);
          boxEl.innerHTML = html;
          remapFontSizeToHeadings(boxEl);
          fixListSpacing(boxEl);
          statusEl.textContent = 'Done.';
        }catch(e){
          console.error(e);
          statusEl.textContent = 'Error loading document.';
          boxEl.innerHTML = '<div style="color:#c00;font-weight:700">เกิดข้อผิดพลาดในการโหลดเอกสาร</div>';
        }
      })();
    })();
  </script>
</body>
</html>