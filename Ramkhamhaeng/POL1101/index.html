<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>POL1101 การเมืองและการปกครองไทย — 20nxskypqz Exam Review</title>

  <link href="https://fonts.googleapis.com/css2?family=Niramit:wght@400;700&display=swap" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />

  <link rel="stylesheet" href="../styles.css" />
</head>
<body class="page-pol1101">
  <header class="header full-bleed">
    <button class="menu-toggle" id="menuToggle" aria-label="Toggle navigation" type="button">
      <span class="material-symbols-outlined">menu</span>
    </button>
    <div data-include="../shared/dark-mode-toggle.html"></div>
  </header>

  <div data-include="../shared/side-menu.html"></div>

  <main class="content">
    <section class="hero">
      <h3 class="hero-title">POL1101 – การเมืองและการปกครองไทย</h3>
    </section>

    <section class="section-card">
      <h4 style="text-align:center; margin:-5px 0 15px 0; font-weight: bold;">ภาค 1 ความนำทั่วไป</h4>
      <h2 class="align-left" style="margin:0 0 8px;">บทที่ 1 – การเมืองการปกครอง รูปแบบ ลักษณะ และลัทธิ</h2>
      <div class="card" id="pol-ch1-status" style="font-weight:700;color:#666;margin-bottom:8px;">Loading document…</div>
      <div class="card" id="pol-ch1-box">Preparing…</div>
      <h2 class="align-left" style="margin:20px 0 8px;">บทที่ 2 – หลักประชาธิปไตย</h2>
      <div class="card" id="pol-ch2-status" style="font-weight:700;color:#666;margin-bottom:8px;">Loading document…</div>
      <div class="card" id="pol-ch2-box">Preparing…</div>
    </section>

    <section class="section-card">
      <h4 style="text-align:center; margin:-5px 0 15px 0; font-weight: bold;">ภาค 2 ประวัติศาสตร์</h4>
      <h2 class="align-left" style="margin:0 0 8px;">บทที่ 3 – สุโขทัย อยุธยา รัตนโกสินทร์</h2>
      <div class="card" id="pol-ch3-status" style="font-weight:700;color:#666;margin-bottom:8px;">Loading document…</div>
      <div class="card" id="pol-ch3-box">Preparing…</div>
      <h2 class="align-left" style="margin:20px 0 8px;">บทที่ 4 – ปฏิวัติ 24 มิถุนายน 2475</h2>
      <div class="card" id="pol-ch4-status" style="font-weight:700;color:#666;margin-bottom:8px;">Loading document…</div>
      <div class="card" id="pol-ch4-box">Preparing…</div>
      <h2 class="align-left" style="margin:20px 0 8px;">บทที่ 5 – กบฏ ปฏิวัติ รัฐประหาร</h2>
      <div class="card" id="pol-ch5-status" style="font-weight:700;color:#666;margin-bottom:8px;">Loading document…</div>
      <div class="card" id="pol-ch5-box">Preparing…</div>
    </section>

    <section class="section-card">
      <h4 style="text-align:center; margin:-5px 0 15px 0; font-weight: bold;">ภาค 3 สถาบัน</h4>
      <h2 class="align-left" style="margin:0 0 8px;">บทที่ 6 – รัฐธรรมนูญ</h2>
      <div class="card" id="pol-ch6-status" style="font-weight:700;color:#666;margin-bottom:8px;">Loading document…</div>
      <div class="card" id="pol-ch6-box">Preparing…</div>
      <h2 class="align-left" style="margin:20px 0 8px;">บทที่ 7 – พระมหากษัตริย์</h2>
      <div class="card" id="pol-ch7-status" style="font-weight:700;color:#666;margin-bottom:8px;">Loading document…</div>
      <div class="card" id="pol-ch7-box">Preparing…</div>
      <h2 class="align-left" style="margin:20px 0 8px;">บทที่ 8 – คณะรัฐมนตรี</h2>
      <div class="card" id="pol-ch8-status" style="font-weight:700;color:#666;margin-bottom:8px;">Loading document…</div>
      <div class="card" id="pol-ch8-box">Preparing…</div>
      <h2 class="align-left" style="margin:20px 0 8px;">บทที่ 9 – รัฐสภา</h2>
      <div class="card" id="pol-ch9-status" style="font-weight:700;color:#666;margin-bottom:8px;">Loading document…</div>
      <div class="card" id="pol-ch9-box">Preparing…</div>
      <h2 class="align-left" style="margin:20px 0 8px;">บทที่ 10 – การบัญญัติกฎหมาย</h2>
      <div class="card" id="pol-ch10-status" style="font-weight:700;color:#666;margin-bottom:8px;">Loading document…</div>
      <div class="card" id="pol-ch10-box">Preparing…</div>
      <h2 class="align-left" style="margin:20px 0 8px;">บทที่ 11 – ตุลาการ</h2>
      <div class="card" id="pol-ch11-status" style="font-weight:700;color:#666;margin-bottom:8px;">Loading document…</div>
      <div class="card" id="pol-ch11-box">Preparing…</div>
      <h2 class="align-left" style="margin:20px 0 8px;">บทที่ 12 – พรรคการเมือง</h2>
      <div class="card" id="pol-ch12-status" style="font-weight:700;color:#666;margin-bottom:8px;">Loading document…</div>
      <div class="card" id="pol-ch12-box">Preparing…</div>
      <h2 class="align-left" style="margin:20px 0 8px;">บทที่ 13 – กลุ่มผลประโยชน์</h2>
      <div class="card" id="pol-ch13-status" style="font-weight:700;color:#666;margin-bottom:8px;">Loading document…</div>
      <div class="card" id="pol-ch13-box">Preparing…</div>
      <h2 class="align-left" style="margin:20px 0 8px;">บทที่ 14 – การเลือกตั้ง</h2>
      <div class="card" id="pol-ch14-status" style="font-weight:700;color:#666;margin-bottom:8px;">Loading document…</div>
      <div class="card" id="pol-ch14-box">Preparing…</div>
    </section>

    <section class="section-card">
        <h4 style="text-align:center; margin:-5px 0 15px 0; font-weight: bold;">ภาค 4 ระเบียบบริหารราชการแผ่นดิน</h4>
        <h2 class="align-left" style="margin:0 0 8px;">บทที่ 15 – การบริหารราชการ</h2>
        <div class="card" id="pol-ch15-status" style="font-weight:700;color:#666;margin-bottom:8px;">Loading document…</div>
        <div class="card" id="pol-ch15-box">Preparing…</div>
        <h2 class="align-left" style="margin:20px 0 8px;">บทที่ 16 – ระเบียบบริหารราชการส่วนกลาง</h2>
        <div class="card" id="pol-ch16-status" style="font-weight:700;color:#666;margin-bottom:8px;">Loading document…</div>
        <div class="card" id="pol-ch16-box">Preparing…</div>
        <h2 class="align-left" style="margin:20px 0 8px;">บทที่ 17 – การปกครองส่วนภูมิภาค</h2>
        <div class="card" id="pol-ch17-status" style="font-weight:700;color:#666;margin-bottom:8px;">Loading document…</div>
        <div class="card" id="pol-ch17-box">Preparing…</div>
        <h2 class="align-left" style="margin:20px 0 8px;">บทที่ 18 – การปกครองส่วนท้องถิ่น (ตอนที่ 1)</h2>
        <div class="card" id="pol-ch18-status" style="font-weight:700;color:#666;margin-bottom:8px;">Loading document…</div>
        <div class="card" id="pol-ch18-box">Preparing…</div>
        <h2 class="align-left" style="margin:20px 0 8px;">บทที่ 19 – การปกครองส่วนท้องถิ่น (ตอนที่ 2)</h2>
        <div class="card" id="pol-ch19-status" style="font-weight:700;color:#666;margin-bottom:8px;">Loading document…</div>
        <div class="card" id="pol-ch19-box">Preparing…</div>
    </section>

  </main>

  <footer class="footer full-bleed">&copy; 2025 20nxskypqz Exam Review</footer>

  <script src="https://unpkg.com/mammoth/mammoth.browser.min.js"></script>
  <script src="../script.js"></script>
  <script>
    // ฟังก์ชัน helper (เหมือนเดิม)
    function normalizeHeadingsByFont(container){ /* ... */ }
    function fixListSpacing(container){ /* ... */ }
    async function loadArrayBuffer(url){ /* ... */ } // ใช้เวอร์ชันล่าสุดที่มี log ละเอียด
    const options = { /* ... */ };

    // *** EDITED: เพิ่มฟังก์ชัน fixOrphanedListItems ***
    function fixOrphanedListItems(container) {
        console.log("[Fixer] Running fixOrphanedListItems...");
        const potentialOrphans = container.querySelectorAll('p');
        let changesMade = false;

        potentialOrphans.forEach((p, index) => {
            // สมมติฐาน: <p> ที่ควรเป็น <li> มักจะมี margin-left หรือ padding-left
            // ค่า 36pt (ประมาณ 48px) เป็นค่าที่พบบ่อยสำหรับการเยื้องระดับแรก ลองปรับค่านี้ได้
            const style = p.getAttribute('style') || '';
            const indentMatch = style.match(/margin-left:\s*([\d.]+)pt/i) || style.match(/padding-left:\s*([\d.]+)pt/i) ||
                                style.match(/margin-left:\s*([\d.]+)px/i) || style.match(/padding-left:\s*([\d.]+)px/i);

            // สมมติฐาน: <p> ที่ควรเป็น <li> มักจะอยู่ติดกับ <ul> หรือ <li> ก่อนหน้า
            const prevElement = p.previousElementSibling;

            if (indentMatch && parseFloat(indentMatch[1]) > 10) { // ต้องมีการเยื้องพอสมควร
                 // หา <ul> ที่ใกล้ที่สุดก่อนหน้า <p> นี้ หรือ <ul> ของ <li> ก่อนหน้า
                 let targetUl = null;
                 if (prevElement) {
                     if (prevElement.tagName === 'UL') {
                         targetUl = prevElement;
                     } else if (prevElement.tagName === 'LI') {
                         // หา <ul> ที่เป็นลูกของ <li> ก่อนหน้า
                         targetUl = prevElement.querySelector('ul');
                         // ถ้าไม่มี ให้ลองหา <ul> ที่เป็นพี่น้องถัดไปของ <li> ก่อนหน้า (กรณี list ต่อกัน)
                         if (!targetUl && prevElement.nextElementSibling && prevElement.nextElementSibling.tagName === 'UL') {
                             targetUl = prevElement.nextElementSibling;
                         }
                         // ถ้ายังไม่มีอีก ลองดูว่า <li> ก่อนหน้าอยู่ใน <ul> หรือเปล่า
                         if (!targetUl && prevElement.parentElement.tagName === 'UL') {
                             targetUl = prevElement.parentElement;
                         }
                     }
                 }

                 // ถ้าหา <ul> เป้าหมายเจอ หรือ <p> นี้อยู่ติดกับ <ul> ก่อนหน้า
                 if (targetUl || (prevElement && prevElement.tagName === 'UL')) {
                     console.log(`[Fixer] Found potential orphan: "${p.textContent.substring(0, 30)}..." with indent ${indentMatch[0]}`);
                     const li = document.createElement('li');
                     // ย้าย content จาก p ไป li (อาจจะต้องปรับปรุงเรื่อง style ถ้ามี)
                     while (p.firstChild) {
                         li.appendChild(p.firstChild);
                     }
                     // เอา style การเยื้องออก (เพราะ ul/li จัดการเอง)
                     li.style.marginLeft = '';
                     li.style.paddingLeft = '';

                     if (targetUl) {
                          // เพิ่ม li เข้าไปใน ul ที่หาเจอ
                          targetUl.appendChild(li);
                          p.remove(); // ลบ p เดิมทิ้ง
                          changesMade = true;
                          console.log(`[Fixer]   Moved to existing UL.`);
                     } else if (prevElement && prevElement.tagName === 'UL') {
                          // เพิ่ม li เข้าไปใน ul ก่อนหน้า
                          prevElement.appendChild(li);
                          p.remove(); // ลบ p เดิมทิ้ง
                          changesMade = true;
                          console.log(`[Fixer]   Moved to previous UL.`);
                     } else {
                         console.log(`[Fixer]   Could not reliably find target UL.`);
                     }

                 }
            }
        });
        if (!changesMade) {
             console.log("[Fixer] No potential orphans found or moved.");
        }
    }


    function makeDocLoader(fileUrl, statusId, boxId){
      const statusEl = document.getElementById(statusId);
      const boxEl    = document.getElementById(boxId);
      if (!statusEl || !boxEl) {
        console.error(`[Loader] Element not found for ${statusId} or ${boxId}`);
        if (statusEl) statusEl.textContent = 'Error: HTML elements missing.';
        return;
      }
      (async () => {
        const fullFileUrl = `files/${fileUrl}`;
        console.log(`[Loader] Starting for: ${fullFileUrl}`);
        statusEl.textContent = 'Loading...';
        boxEl.innerHTML = '<i>Loading content...</i>';
        try{
          const buf = await loadArrayBuffer(fullFileUrl);
          console.log(`[Loader] Attempting Mammoth conversion for ${fullFileUrl}`);
          const { value: html } = await window.mammoth.convertToHtml({ arrayBuffer: buf }, options);

          boxEl.innerHTML = html; // แสดง HTML ดิบก่อน

          // *** EDITED: เรียกใช้ฟังก์ชันแก้ไขหลัง Mammoth แปลงเสร็จ ***
          console.log(`[Loader] Running post-processing for ${fullFileUrl}`);
          normalizeHeadingsByFont(boxEl); // ทำงานเหมือนเดิม
          fixListSpacing(boxEl); // ทำงานเหมือนเดิม
          fixOrphanedListItems(boxEl); // *** ฟังก์ชันใหม่ที่เพิ่มเข้ามา ***

          statusEl.textContent = 'Done.';
          console.log(`[Loader] Successfully loaded and rendered: ${fullFileUrl}`);
        } catch(e) {
          console.error(`[Loader] Failed for ${fullFileUrl}:`, e);
          statusEl.textContent = 'Error loading document.';
          boxEl.innerHTML = `<div style="color:#c00;font-weight:700">เกิดข้อผิดพลาด: ${e.message}</div>`;
        }
      })();
    }

    // เรียกโหลดไฟล์ (เหมือนเดิม)
    makeDocLoader("บทที่ 1 การเมืองการปกครอง รูปแบบ ลักษณะ และลัทธิ.docx", "pol-ch1-status", "pol-ch1-box");
    makeDocLoader("บทที่ 2 หลักประชาธิปไตย.docx", "pol-ch2-status", "pol-ch2-box");
    makeDocLoader("บทที่ 3 สุโขทัย อยุธยา รัตนโกสินทร์.docx", "pol-ch3-status", "pol-ch3-box");
    makeDocLoader("บทที่ 4 ปฏิวัติ 24 มิถุนายน 2475.docx", "pol-ch4-status", "pol-ch4-box");
    makeDocLoader("บทที่ 5 กบฏ ปฏิวัติ รัฐประหาร.docx", "pol-ch5-status", "pol-ch5-box");
    makeDocLoader("บทที่ 6 รัฐธรรมนูญ.docx", "pol-ch6-status", "pol-ch6-box");
    makeDocLoader("บทที่ 7 พระมหากษัตริย์.docx", "pol-ch7-status", "pol-ch7-box");
    makeDocLoader("บทที่ 8 คณะรัฐมนตรี.docx", "pol-ch8-status", "pol-ch8-box");
    makeDocLoader("บทที่ 9 รัฐสภา.docx", "pol-ch9-status", "pol-ch9-box");
    makeDocLoader("บทที่ 10 การบัญญัติกฎหมาย.docx", "pol-ch10-status", "pol-ch10-box");
    makeDocLoader("บทที่ 11 ตุลาการ.docx", "pol-ch11-status", "pol-ch11-box");
    makeDocLoader("บทที่ 12 พรรคการเมือง.docx", "pol-ch12-status", "pol-ch12-box");
    makeDocLoader("บทที่ 13 กลุ่มผลประโยชน์.docx", "pol-ch13-status", "pol-ch13-box");
    makeDocLoader("บทที่ 14 การเลือกตั้ง.docx", "pol-ch14-status", "pol-ch14-box");
    makeDocLoader("บทที่ 15 การบริหารราชการ.docx", "pol-ch15-status", "pol-ch15-box");
    makeDocLoader("บทที่ 16 ระเบียบบริหารราชการส่วนกลาง.docx", "pol-ch16-status", "pol-ch16-box");
    makeDocLoader("บทที่ 17 การปกครองส่วนภูมิภาค.docx", "pol-ch17-status", "pol-ch17-box");
    makeDocLoader("บทที่ 18 การปกครองส่วนท้องถิ่น (ตอนที่ 1).docx", "pol-ch18-status", "pol-ch18-box");
    makeDocLoader("บทที่ 19 การปกครองส่วนท้องถิ่น (ตอนที่ 2).docx", "pol-ch19-status", "pol-ch19-box");

  </script>
</body>
</html>
