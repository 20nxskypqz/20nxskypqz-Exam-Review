<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>POL1101 การเมืองและการปกครองไทย — 20nxskypqz Exam Review</title>

  <!-- ฟอนต์/ไอคอน -->
  <link href="https://fonts.googleapis.com/css2?family=Niramit:wght@400;700&display=swap" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />

  <!-- สไตล์หลักของโปรเจกต์ -->
  <link rel="stylesheet" href="../styles.css" />

  <!-- สไตล์เสริมให้คงที่/แก้ย่อหน้า -->
  <style>
    :root{
      /* ล็อกฐานขนาดให้คาดเดาได้ */
      font-size: 16px;
    }
    body{
      font-family:"Niramit", system-ui, -apple-system, Segoe UI, Roboto, Arial, "TH Sarabun New", sans-serif;
      line-height: 1.6;
    }
    /* scale หัวข้อให้คงที่ ไม่พองเกิน */
    h1{font-size:clamp(1.6rem, 2.5vw, 2.0rem); line-height:1.25}
    h2{font-size:clamp(1.35rem, 2.0vw, 1.6rem); line-height:1.3}
    h3{font-size:clamp(1.2rem, 1.6vw, 1.35rem); line-height:1.35}
    h4{font-size:1.05rem}
    .content{max-width:1100px;margin:0 auto;padding:16px}
    .card{background:#fff;border-radius:12px;box-shadow:0 2px 10px rgba(0,0,0,.05);padding:16px}
    .section-card{margin:24px 0}
    .align-left{text-align:left}
    .status-ok{color:#2e7d32;font-weight:700}
    .status-warn{color:#f57c00;font-weight:700}
    .status-err{color:#c62828;font-weight:700}
    .status-dim{color:#666;font-weight:700}

    /* ---- รายการ: ใช้ padding-left แทน margin เพื่อควบคุมอินเดนท์ ---- */
    ul, ol{ margin: 0 0 .75em 0; padding-left: 1.5em; }
    ul ul, ol ul, ul ol, ol ol{ margin: .25em 0 .25em 0; padding-left: 1.5em; }

    /* ระดับชั้น 1/2/3 เป็น • / ○ / ▪ */
    ul{ list-style-type: disc; }
    ul ul{ list-style-type: circle; }
    ul ul ul{ list-style-type: square; }

    /* ตารางพื้นฐาน */
    table{border-collapse:collapse;width:100%;margin:12px 0}
    th,td{border:1px solid #e0e0e0;padding:8px;vertical-align:top}
    .small-note{font-size:.9rem;color:#666;margin:6px 0 14px}
    .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace}
  </style>
</head>
<body class="page-pol1101">
  <header class="header full-bleed">
    <button class="menu-toggle" id="menuToggle" aria-label="Toggle navigation" type="button">
      <span class="material-symbols-outlined">menu</span>
    </button>
    <div data-include="../shared/dark-mode-toggle.html"></div>
  </header>

  <div data-include="../shared/side-menu.html"></div>

  <main class="content">
    <section class="hero">
      <h3 class="hero-title">POL1101 – การเมืองและการปกครองไทย</h3>
    </section>

    <section class="section-card">
      <h4 style="text-align:center; margin:-5px 0 15px 0; font-weight: bold;">ภาค 1 ความนำทั่วไป</h4>
      <h2 class="align-left" style="margin:0 0 8px;">บทที่ 1 – การเมืองการปกครอง รูปแบบ ลักษณะ และลัทธิ</h2>
      <div class="card status-dim" id="pol-ch1-status">Loading document…</div>
      <div class="card" id="pol-ch1-box">Preparing…</div>

      <h2 class="align-left" style="margin:20px 0 8px;">บทที่ 2 – หลักประชาธิปไตย</h2>
      <div class="card status-dim" id="pol-ch2-status">Loading document…</div>
      <div class="card" id="pol-ch2-box">Preparing…</div>
    </section>

    <section class="section-card">
      <h4 style="text-align:center; margin:-5px 0 15px 0; font-weight: bold;">ภาค 2 ประวัติศาสตร์</h4>
      <h2 class="align-left" style="margin:0 0 8px;">บทที่ 3 – สุโขทัย อยุธยา รัตนโกสินทร์</h2>
      <div class="card status-dim" id="pol-ch3-status">Loading document…</div>
      <div class="card" id="pol-ch3-box">Preparing…</div>

      <h2 class="align-left" style="margin:20px 0 8px;">บทที่ 4 – ปฏิวัติ 24 มิถุนายน 2475</h2>
      <div class="card status-dim" id="pol-ch4-status">Loading document…</div>
      <div class="card" id="pol-ch4-box">Preparing…</div>

      <h2 class="align-left" style="margin:20px 0 8px;">บทที่ 5 – กบฏ ปฏิวัติ รัฐประหาร</h2>
      <div class="card status-dim" id="pol-ch5-status">Loading document…</div>
      <div class="card" id="pol-ch5-box">Preparing…</div>
    </section>

    <section class="section-card">
      <h4 style="text-align:center; margin:-5px 0 15px 0; font-weight: bold;">ภาค 3 สถาบัน</h4>
      <h2 class="align-left" style="margin:0 0 8px;">บทที่ 6 – รัฐธรรมนูญ</h2>
      <div class="card status-dim" id="pol-ch6-status">Loading document…</div>
      <div class="card" id="pol-ch6-box">Preparing…</div>
      <h2 class="align-left" style="margin:20px 0 8px;">บทที่ 7 – พระมหากษัตริย์</h2>
      <div class="card status-dim" id="pol-ch7-status">Loading document…</div>
      <div class="card" id="pol-ch7-box">Preparing…</div>
      <h2 class="align-left" style="margin:20px 0 8px;">บทที่ 8 – คณะรัฐมนตรี</h2>
      <div class="card status-dim" id="pol-ch8-status">Loading document…</div>
      <div class="card" id="pol-ch8-box">Preparing…</div>
      <h2 class="align-left" style="margin:20px 0 8px;">บทที่ 9 – รัฐสภา</h2>
      <div class="card status-dim" id="pol-ch9-status">Loading document…</div>
      <div class="card" id="pol-ch9-box">Preparing…</div>
      <h2 class="align-left" style="margin:20px 0 8px;">บทที่ 10 – การบัญญัติกฎหมาย</h2>
      <div class="card status-dim" id="pol-ch10-status">Loading document…</div>
      <div class="card" id="pol-ch10-box">Preparing…</div>
      <h2 class="align-left" style="margin:20px 0 8px;">บทที่ 11 – ตุลาการ</h2>
      <div class="card status-dim" id="pol-ch11-status">Loading document…</div>
      <div class="card" id="pol-ch11-box">Preparing…</div>
      <h2 class="align-left" style="margin:20px 0 8px;">บทที่ 12 – พรรคการเมือง</h2>
      <div class="card status-dim" id="pol-ch12-status">Loading document…</div>
      <div class="card" id="pol-ch12-box">Preparing…</div>
      <h2 class="align-left" style="margin:20px 0 8px;">บทที่ 13 – กลุ่มผลประโยชน์</h2>
      <div class="card status-dim" id="pol-ch13-status">Loading document…</div>
      <div class="card" id="pol-ch13-box">Preparing…</div>
      <h2 class="align-left" style="margin:20px 0 8px;">บทที่ 14 – การเลือกตั้ง</h2>
      <div class="card status-dim" id="pol-ch14-status">Loading document…</div>
      <div class="card" id="pol-ch14-box">Preparing…</div>
    </section>

    <section class="section-card">
      <h4 style="text-align:center; margin:-5px 0 15px 0; font-weight: bold;">ภาค 4 ระเบียบบริหารราชการแผ่นดิน</h4>
      <h2 class="align-left" style="margin:0 0 8px;">บทที่ 15 – การบริหารราชการ</h2>
      <div class="card status-dim" id="pol-ch15-status">Loading document…</div>
      <div class="card" id="pol-ch15-box">Preparing…</div>
      <h2 class="align-left" style="margin:20px 0 8px;">บทที่ 16 – ระเบียบบริหารราชการส่วนกลาง</h2>
      <div class="card status-dim" id="pol-ch16-status">Loading document…</div>
      <div class="card" id="pol-ch16-box">Preparing…</div>
      <h2 class="align-left" style="margin:20px 0 8px;">บทที่ 17 – การปกครองส่วนภูมิภาค</h2>
      <div class="card status-dim" id="pol-ch17-status">Loading document…</div>
      <div class="card" id="pol-ch17-box">Preparing…</div>
      <h2 class="align-left" style="margin:20px 0 8px;">บทที่ 18 – การปกครองส่วนท้องถิ่น (ตอนที่ 1)</h2>
      <div class="card status-dim" id="pol-ch18-status">Loading document…</div>
      <div class="card" id="pol-ch18-box">Preparing…</div>
      <h2 class="align-left" style="margin:20px 0 8px;">บทที่ 19 – การปกครองส่วนท้องถิ่น (ตอนที่ 2)</h2>
      <div class="card status-dim" id="pol-ch19-status">Loading document…</div>
      <div class="card" id="pol-ch19-box">Preparing…</div>
    </section>
  </main>

  <footer class="footer full-bleed">&copy; 2025 20nxskypqz Exam Review</footer>

  <!-- Mammoth: ถ้าเปิดแบบออฟไลน์ ให้ดาวน์โหลดไฟล์มาไว้ข้างๆ และแก้เป็น ./mammoth.browser.min.js -->
  <script src="https://unpkg.com/mammoth/mammoth.browser.min.js"></script>
  <!-- <script src="./mammoth.browser.min.js"></script> -->

  <!-- สคริปต์รวมของโปรเจกต์ (ถ้าใช้ data-include) -->
  <script src="../script.js"></script>

  <script>
    /*************** สถานะเล็ก ๆ ***************/
    function setStatus(el, text, cls){
      if(!el) return;
      el.textContent = text;
      el.classList.remove('status-ok','status-warn','status-err','status-dim');
      if (cls) el.classList.add(cls);
    }
    function humanFileSize(bytes) {
      if (isNaN(bytes)) return "?";
      const k=1024; if (Math.abs(bytes)<k) return bytes+' B';
      const u=['KB','MB','GB']; let i=-1; do{bytes/=k;++i}while(Math.abs(bytes)>=k && i<u.length-1);
      return bytes.toFixed(1)+' '+u[i];
    }

    /*************** โหลดไฟล์ .docx ***************/
    async function loadArrayBuffer(url){
      console.log(`[Fetch] GET ${url}`);
      const res = await fetch(url + (url.includes('?')?'&':'?') + '_ts=' + Date.now(), { cache:'no-store' });
      if(!res.ok) throw new Error(`HTTP ${res.status} – โหลดไม่ได้: ${url}`);
      const buf = await res.arrayBuffer();
      console.log(`[Fetch] Done ${url} size=${humanFileSize(buf.byteLength)}`);
      return buf;
    }

    /*************** ปิด/ควบคุมการโปรโมตหัวข้อ ***************/
    const headingAutoPromoteEnabled = false; // ปิดไว้ก่อนเพื่อกัน “ตัวใหญ่”
    function normalizeHeadingsByStrong(container){
      if(!headingAutoPromoteEnabled || !container) return;
      // ถ้าจะเปิด ให้เข้มงวด: ต้อง match คำขึ้นต้นเป็น "บทที่/ภาคที่" เท่านั้น
      const re = /^(บทที่|ภาค)\s*\d+/;
      const paras = Array.from(container.querySelectorAll('p'));
      let changed = 0;
      paras.forEach(p=>{
        const onlyChild = p.childNodes.length === 1 && p.firstElementChild && p.firstElementChild.tagName === 'STRONG';
        if(onlyChild){
          const text = p.textContent.trim();
          if(re.test(text) && text.length<=80){
            const h = document.createElement('h3');
            h.textContent = text;
            p.replaceWith(h);
            changed++;
          }
        }
      });
      console.log(`[Normalize] promote -> <h3>: ${changed} changed`);
    }

    /*************** รวมบูลเล็ตปลอม => <ul><li> (คง inline formatting) ***************/
    function normalizeLists(root){
      if(!root) return;
      console.log("[Normalize] Running normalizeLists...");
      // bullet ที่มักเจอ + dash ต่าง ๆ
      const bulletRegex = /^([•◦○▪■\-–—])\s+/;

      // ประเมินระดับจาก style="margin-left:..", &nbsp;/space หรือแท็บ
      const unitToPx = (val, unit) => {
        const dpi = 96;
        switch(unit){
          case 'px': return val;
          case 'pt': return val * (96/72);
          case 'cm': return val * (dpi/2.54);
          case 'mm': return val * (dpi/25.4);
          case 'in': return val * dpi;
          default: return val;
        }
      };
      const getLevelByStyle = (el) => {
        const style = (el.getAttribute && el.getAttribute('style')) || '';
        const m = /margin-left:\s*([\d\.]+)(cm|mm|in|px|pt)/i.exec(style);
        if(!m) return null;
        const px = unitToPx(parseFloat(m[1]), (m[2]||'px').toLowerCase());
        return Math.min(3, Math.max(0, Math.round(px/24))); // ทุก ๆ ~24px = 1 level
      };
      const getLevelBySpaces = (text) => {
        const mNbsp = text.match(/^(?:\u00a0|\s){1,}/); // เริ่มบรรทัดเป็นช่องว่าง/nbsp
        if(!mNbsp) return 0;
        const n = mNbsp[0].length;
        return Math.min(3, Math.floor(n/2)); // 2 ช่องต่อ 1 level (หยาบ ๆ)
      };

      const paragraphs = Array.from(root.querySelectorAll("p"));
      let currentStack = []; // เก็บ ul ตาม level
      let changesMade = 0;

      const closeTo = (level) => {
        while(currentStack.length > level+1){
          currentStack.pop();
        }
      };
      const ensureUlForLevel = (refNode, level) => {
        if(!currentStack[level]){
          closeTo(level-1);
          const ul = document.createElement('ul');
          // กำหนด list-style ตามระดับ (ซ้ำกับ CSS เพื่อให้แน่ใจ)
          ul.style.listStyleType = (level===0?'disc':(level===1?'circle':'square'));
          refNode.parentNode.insertBefore(ul, refNode);
          currentStack[level] = ul;
        }
      };

      paragraphs.forEach(p=>{
        const raw = p.textContent || "";
        const match = bulletRegex.exec(raw);
        if(!match){
          currentStack = []; // หลุดจากรายการ
          return;
        }

        // หาระดับ
        let level = getLevelByStyle(p);
        if(level === null) level = getLevelBySpaces(p.textContent);

        ensureUlForLevel(p, level);
        closeTo(level);

        // สร้าง <li> โดย “ย้ายโหนดลูก” (เพื่อคง bold/italic/ลิงก์)
        const li = document.createElement('li');

        // clone childNodes แล้วตัด bullet ออกจากโหนดแรก
        const frag = document.createDocumentFragment();
        Array.from(p.childNodes).forEach((node, idx)=>{
          if(idx===0 && node.nodeType===Node.TEXT_NODE){
            const replaced = node.textContent.replace(bulletRegex,''); // ตัด bullet + เว้นวรรคแรก
            const trimmed = replaced.replace(/^\u00a0+/, ''); // ตัด nbsp นำหน้า
            frag.appendChild(document.createTextNode(trimmed));
          }else{
            frag.appendChild(node.cloneNode(true));
          }
        });
        li.appendChild(frag);
        currentStack[level].appendChild(li);
        p.remove();
        changesMade++;
      });

      console.log(`[Normalize] Lists: converted ${changesMade} paragraphs.`);
    }

    /*************** เกลี่ยช่องไฟรอบรายการ ***************/
    function fixListSpacing(container){
      if(!container) return;
      container.querySelectorAll('ul,ol').forEach(list=>{
        list.style.marginTop = list.style.marginTop || '0.25em';
        list.style.marginBottom = list.style.marginBottom || '0.75em';
      });
      // ลบ <p> ว่างที่ติดรอบลิสต์
      container.querySelectorAll('p').forEach(p=>{
        if(!p.textContent.trim() && (p.previousElementSibling?.matches('ul,ol') || p.nextElementSibling?.matches('ul,ol'))){
          p.remove();
        }
      });
    }

    /*************** ตัวเลือก Mammoth ***************/
    const options = {
      styleMap: [
        "p[style-name='Title'] => h1:fresh",
        "p[style-name='Subtitle'] => h2:fresh",
        "u => u",
        "strike => s"
      ],
      includeEmbeddedStyleMap: true,
      convertImage: mammoth.images.inline(function(element) {
        return element.read("base64").then(function(imageBuffer) {
          return { src: "data:" + element.contentType + ";base64," + imageBuffer };
        });
      })
    };

    /*************** โหลด-แปลง-แสดง ***************/
    function makeDocLoader(fileName, statusId, boxId){
      const statusEl = document.getElementById(statusId);
      const boxEl    = document.getElementById(boxId);
      if (!statusEl || !boxEl) return;

      (async () => {
        const url = `files/${fileName}`;
        setStatus(statusEl, `Loading: ${fileName}`, 'status-dim');
        boxEl.innerHTML = '<span class="small-note mono">Preparing…</span>';
        try{
          if(!window.mammoth){
            setStatus(statusEl,'ไม่พบ Mammoth.js (ตรวจสคริปต์/การบล็อก CDN)', 'status-err');
            boxEl.innerHTML = '<div class="small-note">Cannot start conversion because mammoth is not loaded.</div>';
            return;
          }
          const buf = await loadArrayBuffer(url);
          setStatus(statusEl, `Converting (${humanFileSize(buf.byteLength)})…`, 'status-dim');

          const result = await window.mammoth.convertToHtml({ arrayBuffer: buf }, options);
          const html   = result.value;
          const notes  = result.messages || [];

          boxEl.innerHTML = html;

          // Post-process (หัวข้อถูกปิดไว้, รายการ + spacing เปิดไว้)
          normalizeHeadingsByStrong(boxEl);
          normalizeLists(boxEl);
          fixListSpacing(boxEl);

          if (notes.length){
            setStatus(statusEl, `Done with notes (${notes.length}).`, 'status-warn');
            console.log(`[Mammoth Notes] ${fileName}`, notes);
          }else{
            setStatus(statusEl, 'Done.', 'status-ok');
          }
        }catch(e){
          console.error(e);
          setStatus(statusEl, `Error: ${e.message}`, 'status-err');
          boxEl.innerHTML = `<div class="small-note">โหลด/แปลงไม่สำเร็จ: <span class="mono">${e.message}</span></div>`;
        }
      })();
    }

    /*************** เรียกทุกบท ***************/
    document.addEventListener('DOMContentLoaded', () => {
      // ภาค 1
      makeDocLoader("บทที่ 1 การเมืองการปกครอง รูปแบบ ลักษณะ และลัทธิ.docx", "pol-ch1-status", "pol-ch1-box");
      makeDocLoader("บทที่ 2 หลักประชาธิปไตย.docx", "pol-ch2-status", "pol-ch2-box");

      // ภาค 2
      makeDocLoader("บทที่ 3 สุโขทัย อยุธยา รัตนโกสินทร์.docx", "pol-ch3-status", "pol-ch3-box");
      makeDocLoader("บทที่ 4 ปฏิวัติ 24 มิถุนายน 2475.docx", "pol-ch4-status", "pol-ch4-box");
      makeDocLoader("บทที่ 5 กบฏ ปฏิวัติ รัฐประหาร.docx", "pol-ch5-status", "pol-ch5-box");

      // ภาค 3
      makeDocLoader("บทที่ 6 รัฐธรรมนูญ.docx", "pol-ch6-status", "pol-ch6-box");
      makeDocLoader("บทที่ 7 พระมหากษัตริย์.docx", "pol-ch7-status", "pol-ch7-box");
      makeDocLoader("บทที่ 8 คณะรัฐมนตรี.docx", "pol-ch8-status", "pol-ch8-box");
      makeDocLoader("บทที่ 9 รัฐสภา.docx", "pol-ch9-status", "pol-ch9-box");
      makeDocLoader("บทที่ 10 การบัญญัติกฎหมาย.docx", "pol-ch10-status", "pol-ch10-box");
      makeDocLoader("บทที่ 11 ตุลาการ.docx", "pol-ch11-status", "pol-ch11-box");
      makeDocLoader("บทที่ 12 พรรคการเมือง.docx", "pol-ch12-status", "pol-ch12-box");
      makeDocLoader("บทที่ 13 กลุ่มผลประโยชน์.docx", "pol-ch13-status", "pol-ch13-box");
      makeDocLoader("บทที่ 14 การเลือกตั้ง.docx", "pol-ch14-status", "pol-ch14-box");

      // ภาค 4
      makeDocLoader("บทที่ 15 การบริหารราชการ.docx", "pol-ch15-status", "pol-ch15-box");
      makeDocLoader("บทที่ 16 ระเบียบบริหารราชการส่วนกลาง.docx", "pol-ch16-status", "pol-ch16-box");
      makeDocLoader("บทที่ 17 การปกครองส่วนภูมิภาค.docx", "pol-ch17-status", "pol-ch17-box");
      makeDocLoader("บทที่ 18 การปกครองส่วนท้องถิ่น (ตอนที่ 1).docx", "pol-ch18-status", "pol-ch18-box");
      makeDocLoader("บทที่ 19 การปกครองส่วนท้องถิ่น (ตอนที่ 2).docx", "pol-ch19-status", "pol-ch19-box");
    });
  </script>
</body>
</html>