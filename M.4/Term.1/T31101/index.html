<!-- T31101-HTML-03102025-[Complete] -->
<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>T31101 — 20nxskypqz Exam Review</title>

  <!-- Material Symbols (CDN) -->
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />

  <!-- Niramit -->
  <link href="https://fonts.googleapis.com/css2?family=Niramit:wght@400;700&display=swap" rel="stylesheet" />

  <!-- Global styles (Exam Review) -->
  <link rel="stylesheet" href="/20nxskypqz-Exam-Review/styles.css" />
</head>
<body>
  <!-- shared header + side menu -->
  <div data-include="/20nxskypqz-Exam-Review/shared/header.html"></div>
  <div data-include="/20nxskypqz-Exam-Review/shared/side-menu.html"></div>

  <main class="content">
    <section class="hero">
      <h1 class="align-left" style="margin:.2em 0 .4em;">ท31101</h1>
    </section>

    <section class="section-card">
      <h2 class="align-left" style="margin:0 0 8px;">Midterm</h2>
      <div class="card" id="midterm-box">
        <em>Coming soon.</em>
      </div>
    </section>

    <section class="section-card">
      <h2 class="align-left" style="margin:0 0 8px;">Final</h2>
      <div class="card" id="final-status" style="font-weight:700;color:#666;margin-bottom:8px;">Loading document…</div>
      <div class="card" id="final-box">Preparing…</div>
    </section>
  </main>

  <!-- shared footer -->
  <div data-include="/20nxskypqz-Exam-Review/shared/footer.html"></div>

  <!-- Mammoth (DOCX → HTML) -->
  <script src="https://unpkg.com/mammoth/mammoth.browser.min.js"></script>

  <!-- Global script (handles includes, menu, theme, etc.) -->
  <script src="/20nxskypqz-Exam-Review/script.js"></script>

  <script>
    // Render Final DOCX with Mammoth
    (function () {
      const finalStatus = document.getElementById('final-status');
      const finalBox    = document.getElementById('final-box');
      const fileUrl     = "/20nxskypqz-Exam-Review/files/m.4/term.1/ท31101_final.docx";

      const options = {
        styleMap: [
          "p[style-name='Title'] => h1:fresh",
          "p[style-name='Subtitle'] => h2:fresh",
          "p[style-name='Heading 1'] => h1:fresh",
          "p[style-name='Heading 2'] => h2:fresh",
          "p[style-name='Heading 3'] => h3:fresh",
          "b => strong",
          "i => em"
        ]
      };

      function fixListSpacing(container){
        container.querySelectorAll('li').forEach(li=>{
          li.innerHTML = li.innerHTML
            .replace(/^(\d+)\.\s?/, (_,m)=> m + '. ')
            .replace(/^•\s?/, '• ');
        });
      }

      async function loadArrayBuffer(url){
        const res = await fetch(encodeURI(url), { cache: 'no-store' });
        if(!res.ok) throw new Error('โหลดไฟล์ไม่ได้: ' + url + ' [' + res.status + ']');
        return await res.arrayBuffer();
      }

      (async () => {
        try{
          const buf = await loadArrayBuffer(fileUrl);
          const { value: html } = await window.mammoth.convertToHtml({ arrayBuffer: buf }, options);
          finalBox.innerHTML = html;
          fixListSpacing(finalBox);
          finalStatus.textContent = 'Done.';
        }catch(e){
          console.error(e);
          finalStatus.textContent = 'Error loading document.';
          finalBox.innerHTML = '<div style="color:#c00;font-weight:700">เกิดข้อผิดพลาดในการโหลดเอกสาร</div>';
        }
      })();
    })();
  </script>
</body>
</html>