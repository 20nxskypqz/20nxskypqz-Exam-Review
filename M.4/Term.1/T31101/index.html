<!-- ExamReview-T31101-html-03102025-[Complete] -->
<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>T31101 • 20nxskypqz Exam Review</title>

  <link href="https://fonts.googleapis.com/css2?family=Niramit:wght@400;700&display=swap" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />

  <link rel="stylesheet" href="../../styles.css" />
</head>
<body>
  <div data-include="../../shared/header.html"></div>
  <div data-include="../../shared/side-menu.html"></div>

  <main class="content">
    <section class="hero">
      <h1>ท31101</h1>
    </section>

    <section class="section-card">
      <h2 class="align-left">Midterm</h2>
      <div class="card" id="midterm-holder">
        <!-- กล่องว่างไว้ก่อน -->
        <p style="margin:0;color:var(--muted)">—</p>
      </div>
    </section>

    <section class="section-card">
      <h2 class="align-left">Final</h2>
      <div class="card" id="final-holder">
        กำลังโหลดเอกสาร…
      </div>
    </section>
  </main>

  <div data-include="../../shared/footer.html"></div>

  <!-- Mammoth.js -->
  <script src="https://unpkg.com/mammoth/mammoth.browser.min.js"></script>
  <script>
    async function includePartials() {
      const nodes = Array.from(document.querySelectorAll('[data-include]'));
      for (const node of nodes) {
        const url = node.getAttribute('data-include');
        const res = await fetch(url, { cache: 'no-store' });
        const html = await res.text();
        const temp = document.createElement('div'); temp.innerHTML = html.trim();
        const frag = document.createDocumentFragment(); while (temp.firstChild) frag.appendChild(temp.firstChild);
        node.replaceWith(frag);
      }
    }

    const styleMap = [
      "p[style-name='Title'] => h1:fresh",
      "p[style-name='Subtitle'] => h2:fresh",
      "p[style-name='Heading 1'] => h1:fresh",
      "p[style-name='Heading 2'] => h2:fresh",
      "p[style-name='Heading 3'] => h3:fresh",
      "b => strong",
      "i => em"
    ];

    async function loadArrayBuffer(url){
      const res = await fetch(encodeURI(url), { cache: 'no-store' });
      if(!res.ok) throw new Error('โหลดไฟล์ไม่ได้: '+url+' ['+res.status+']');
      return await res.arrayBuffer();
    }

    async function renderFinal(){
      const holder = document.getElementById('final-holder');
      try{
        const buf = await loadArrayBuffer('../../../files/m.4/term.1/ท31101_final.docx');
        const { value: html } = await window.mammoth.convertToHtml({ arrayBuffer: buf }, { styleMap });
        holder.innerHTML = html;
      }catch(e){
        console.error(e);
        holder.innerHTML = '<div style="color:#c00;font-weight:700">โหลดเอกสารไม่ได้</div>';
      }
    }

    document.addEventListener('DOMContentLoaded', async ()=>{
      await includePartials();
      await renderFinal();
    });
  </script>

  <script src="../../script.js"></script>
</body>
</html>